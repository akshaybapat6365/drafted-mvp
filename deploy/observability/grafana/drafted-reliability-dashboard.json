{
  "title": "Drafted Reliability",
  "timezone": "utc",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "30s",
  "panels": [
    {
      "id": 1,
      "title": "API P95 Latency (ms)",
      "type": "timeseries",
      "targets": [
        {
          "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_ms_bucket{service=\"drafted-api\"}[5m])) by (le))",
          "legendFormat": "p95"
        }
      ]
    },
    {
      "id": 2,
      "title": "Retry Adherence %",
      "type": "stat",
      "targets": [
        {
          "expr": "100 * sum(rate(drafted_retry_adhered_total[10m])) / clamp_min(sum(rate(drafted_retryable_total[10m])), 1)"
        }
      ]
    },
    {
      "id": 3,
      "title": "Job Failures by Class",
      "type": "timeseries",
      "targets": [
        {
          "expr": "sum(rate(drafted_job_failures_total[5m])) by (failure_code)"
        }
      ]
    },
    {
      "id": 4,
      "title": "Queue Depth",
      "type": "timeseries",
      "targets": [
        {
          "expr": "drafted_queue_jobs{status=~\"queued|running\"}"
        }
      ]
    }
  ]
}
